!function t(e,n,r){function i(s,u){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e){var n,r,i,o;o=t("./stage"),i=t("./render"),r=t("./primitives"),n=function(){function t(t,e,n,s){null==s&&(s=[]),this.scene=new i.Scene(e),this.renderables=new i.Factory(t,i.Types.Classes),this.attributes=new r.Attributes(r.Types.Traits,r.Types.Types),this.primitives=new r.Factory(r.Types.Classes,this.attributes,this.renderables),this.model=new o.Model(n),this.controller=new o.Controller(this.model,this.scene,this.primitives),this.animator=new o.Animator(this.model),this.director=new o.Director(this.controller,this.animator,s),this.api=new o.API(this.controller,this.animator,this.director)}return t.prototype.init=function(){return this.scene.inject()},t.prototype.destroy=function(){return this.scene.unject()},t.prototype.update=function(){return this.animator.update(),this.attributes.digest()},t}(),e.exports=n},{"./primitives":5,"./render":25,"./stage":35}],2:[function(t,e,n){var r,i;i=function(t){var e;return null==t&&(t={}),null==t.plugins&&(t.plugins=["core","mathbox"]),e=THREE.Bootstrap(t),e.mathbox},window.MathBox=n,window.mathBox=n.mathBox=i,n.version="2",r=t("./context"),THREE.Bootstrap.registerPlugin("mathbox",{defaults:{init:!0},listen:["ready","update"],install:function(t){var e;return e=!1,t.MathBox={init:function(n){return function(i){var o,s,u;if(!e)return e=!0,s=(null!=i?i.scene:void 0)||n.options.scene||t.scene,o=(null!=i?i.camera:void 0)||n.options.camera||t.camera,u=(null!=i?i.script:void 0)||n.options.script,n.context=new r(t.renderer.context,s,o,u),n.context.api.three=t,t.mathbox=n.context.api,n.context.init()}}(this),destroy:function(n){return function(){return e?(e=!1,n.context.destroy(),delete t.mathbox,delete n.context.api.three,delete n.context):void 0}}(this),object:function(){var t;return null!=(t=this.context)?t.scene.getRoot():void 0}}},uninstall:function(t){return t.MathBox.destroy(),delete t.MathBox},ready:function(t,e){return this.options.init?e.MathBox.init():void 0},update:function(){var t;return null!=(t=this.context)?t.update():void 0}})},{"./context":1}],3:[function(t,e){var n,r;n=function(){function t(t,e){this.traits=t,this.types=e,this.pending=[]}return t.prototype.make=function(t){return{type:"function"==typeof t.uniform?t.uniform():void 0,value:t.make()}},t.prototype.getSpec=function(t){return this.traits[t]},t.prototype.queue=function(t){return this.pending.push(t)},t.prototype.apply=function(t,e){return null==e&&(e=[]),new r(t,e,this)},t.prototype.digest=function(){var t,e,n,r,i,o;for(n=10;this.pending.length>0&&--n>0;)for(o=[this.pending,[]],e=o[0],this.pending=o[1],r=0,i=e.length;i>r;r++)(t=e[r])();if(0===n)throw console.error("While digesting: ",object),Error("Infinite loop in Data::digest")},t}(),r=function(){function t(t,e,n){var r,i,o,s,u,a,c,l,h,p,f,d,y,v,m,g,_,x,b;for(null==e&&(e=[]),a=function(t){return function(e){var n;return null!=(n=t[e])?n.value:void 0}}(this),f=function(t){return function(e,n,i){var o;return o=v(e,n,t[e].value),null!=o&&(t[e].value=o),i?void 0:r(e)}}(this),t.get=function(t){return function(e){var n,r;if(null!=e)return a(e);n={};for(e in t)r=t[e],n[e]=r.value;return n}}(this),t.set=function(t,e,n){var r;if(null!=t&&null!=e)null!=m[t]&&f(t,e,n);else{r=t;for(t in r)e=r[t],null!=m[t]&&f(t,e,n)}},l={},m={},v=function(t,e,n){return m[t](e,n)},t.validate=function(t,e){var n,r,i;return n=l[t],null!=n&&(i=n()),r=v(t,e,i),null!=r?r:i},s=!1,i={},r=function(t){return function(e){return s||(s=!0,n.queue(o)),i[e]=t[e].value}}(this),u={type:"change",changed:null},o=function(){return u.changed=i,i={},s=!1,t.trigger(u)},g={},_=0,x=e.length;x>_;_++){y=e[_],b=y.split(":"),y=b[0],h=b[1],null==h&&(h=y),d=n.getSpec(y);for(c in d)p=d[c],c=[h,c].join("."),this[c]={type:"function"==typeof p.uniform?p.uniform():void 0,value:p.make()},l[c]=p.make,m[c]=p.validate}}return t}(),e.exports=n},{}],4:[function(t,e){var n;n=function(){function t(t,e,n){this.classes=t,this.attributes=e,this.renderables=n}return t.prototype.getTypes=function(){return Object.keys(this.classes)},t.prototype.make=function(t,e){return new this.classes[t](e,this.attributes,this.renderables)},t}(),e.exports=n},{}],5:[function(t,e,n){n.Factory=t("./factory"),n.Primitive=t("./primitive"),n.Attributes=t("./attributes"),n.Types=t("./types")},{"./attributes":3,"./factory":4,"./primitive":6,"./types":11}],6:[function(t,e){var n;n=function(){function t(t,e,n){this._attributes=e,this._factory=n,this.attributes=this._attributes.apply(this,this.traits),this.parent=null,this.root=null,this.inherited=[],null==this.traits&&(this.traits=[]),this.set(t,null,!0),this.on("change",function(t){return function(e){return t.root?t._change(e.changed):void 0}}(this))}return t.prototype.rebuild=function(){return this.root?(this._unmake(),this._make(),this._change({},!0)):void 0},t.prototype._make=function(){},t.prototype._unmake=function(){},t.prototype._added=function(t){return this.parent=t,this.root=t.root,this._make(),this._change({},!0)},t.prototype._removed=function(){return this._unmake(),this.root=this.parent=null},t.prototype._render=function(t){return this.trigger({type:"render",renderable:t})},t.prototype._unrender=function(t){return this.trigger({type:"unrender",renderable:t})},t.prototype._transform=function(t){var e;return null!=(e=this.parent)?e._transform(t):void 0},t.prototype._traits=function(){return null==this.traits&&(this.traits=[]),this.traits=[].concat.apply(this.traits,arguments)},t.prototype._change=function(){},t.prototype._listen=function(t,e){var n,r;if(t!==this)return n=function(t){return function(n){var r;return r=n.changed,t.root&&null!=r[e]?t._change(r):void 0}}(this),t.on("change",n),r=[t,n],this.inherited.push(r)},t.prototype._unlisten=function(t){var e,n;return n=t[0],e=t[1],n.off("change",e)},t.prototype._inherit=function(t,e){return null==e&&(e=this),null!=this.get(t)?(e._listen(this,t),this):null!=this.parent?this.parent._inherit(t,e):null},t.prototype._unherit=function(){var t,e,n,r;for(r=this.inherited,e=0,n=r.length;n>e;e++)t=r[e],this._unlisten(t);return this.inherited=[]},t}(),THREE.Binder.apply(n.prototype),e.exports=n},{}],7:[function(t,e){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../primitive"),n=function(t){function e(t,n,r){this._traits("object","style","line","axis"),e.__super__.constructor.call(this,t,n,r),this.line=null}return o(e,t),e.prototype._make=function(){var t,e,n,r,i;return this.inherit=this._inherit("view.range"),t=this.get("axis.detail"),n=t+1,e=1/t,r=this._attributes.types,i={lineWidth:this.attributes["line.width"],lineColor:this.attributes["style.color"],lineOpacity:this.attributes["style.opacity"],axisPosition:this._attributes.make(r.vec4()),axisStep:this._attributes.make(r.vec4())},this.axisPosition=i.axisPosition.value,this.axisStep=i.axisStep.value,this.resolution=1/t,this.line=this._factory.make("line",{uniforms:i,samples:n}),this._render(this.line)},e.prototype._unmake=function(){return this._unrender(this.line),this.line.dispose(),this.line=null,this._unherit()},e.prototype._change=function(t,e){var n,r,i,o,s,u,a,c,l,h;return null!=t["axis.detail"]&&this.rebuild(),null!=t["view.range"]||null!=t["axis.range"]||null!=t["axis.dimension"]||null!=t["axis.inherit"]||e?(r=this.get("axis.inherit"),n=this.get("axis.dimension"),r&&this.inherit?(u=this.inherit.get("view.range"),s=u[n-1]):s=this.get("axis.range"),o=s.x,i=s.y,c=1===n?1:0,l=2===n?1:0,h=3===n?1:0,a=4===n?1:0,this.axisPosition.set(c,l,h,a).multiplyScalar(o),this.axisStep.set(c,l,h,a).multiplyScalar((i-o)*this.resolution)):void 0},e}(r),e.exports=n},{"../primitive":6}],8:[function(t,e){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("./view"),n=function(t){function e(t,n,r){e.__super__.constructor.call(this,t,n,r)}return o(e,t),e.prototype._make=function(){var t;return t=this._attributes.types,this.uniforms={cartesianMatrix:this._attributes.make(t.mat4())},this.cartesianMatrix=this.uniforms.cartesianMatrix.value,this.rotationMatrix=new THREE.Matrix4},e.prototype._unmake=function(){return delete this.cartesianMatrix,delete this.rotationMatrix},e.prototype._change=function(){var t,e,n,r,i,o,s,u,a,c,l,h,p;return r=this.get("object.position"),s=this.get("object.scale"),i=this.get("object.rotation"),o=this.get("view.range"),l=o[0].x,h=o[1].x,p=o[2].x,t=o[0].y-l||1,e=o[1].y-h||1,n=o[2].y-p||1,u=s[0],a=s[1],c=s[2],this.cartesianMatrix.set(2*u/t,0,0,-(2*l+t)*u/t,0,2*a/e,0,-(2*h+e)*a/e,0,0,2*c/n,-(2*p+n)*c/n,0,0,0,1),this.rotationMatrix.makeRotationFromQuaternion(i),this.cartesianMatrix.multiplyMatrices(this.rotationMatrix,this.cartesianMatrix)},e.prototype.to=function(t){return t.applyMatrix4(this.cartesianMatrix)},e.prototype._transform=function(t){var e;return t.snippet("cartesian",this.uniforms),null!=(e=this.parent)?e._transform(t):void 0},e}(r),e.exports=n},{"./view":15}],9:[function(t,e){var n,r,i,o,s={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../primitive"),i=t("../../util").Ticks,o=t("./types"),n=function(t){function e(t,n,r){this._traits("line","object","grid","axis:axis[0]","axis:axis[1]"),e.__super__.constructor.call(this,t,n,r),this.widths=[],this.lines=null,this.buffers=null,this.grids=[]}return u(e,t),e.prototype._make=function(){var t,e,n;return this.inherit=this._inherit("view"),n={lineWidth:this.attributes["line.width"],lineColor:this.attributes["style.color"],lineOpacity:this.attributes["style.opacity"]},e=function(t){var e,r,i,o,s,u,a,c;u=this._attributes.types,r={gridRange:this._attributes.make(u.vec2(-1,1)),gridAxis:this._attributes.make(u.vec3(0,2,0)),gridOffset:this._attributes.make(u.vec2(0,-1,0))};for(i in n)a=n[i],r[i]=a;return s=this.get(t+"ticks"),c=2*s,e=this._factory.make("databuffer",{samples:c,channels:1}),o=this._factory.make("line",{uniforms:n,buffer:e}),this.widths.push(c),this.buffers.push(e),this.lines.push(o),this.grids.push(r),this._render(o)},t=this.get("grid.axes"),e("axis[0].",t[0])},e.prototype._unmake=function(){var t,e,n,r,i,o,s,u;for(s=this.buffers,n=0,i=s.length;i>n;n++)t=s[n],t.dispose();for(u=this.lines,r=0,o=u.length;o>r;r++)e=u[r],this._unrender(e),e.dispose();return this.widths=[],this.lines=null,this.buffers=null},e.prototype._change=function(t){var e,n;return null!=t["axis1.ticks"]||null!=t["axis2.ticks"]?this.rebuild():(n=function(t,e,n){var r,o,s,u,a,c,l,h,p;return o=this.get(t+"inherit"),o&&this.inherit?(c=this.inherit.get("view.range"),a=c[e]):a=this.get(t+"range"),h=this.get(t+"ticks"),p=this.get(t+"unit"),r=this.get(t+"base"),l=this.get(t+"scale"),u=a.x,s=a.y,h=i.make(l,u,s,h,p,r),n.copy(h)},e=this.get("grid.axes"),n("axis[0].",e[0],this.buffer[0],this.grid[0]))},e}(r),e.exports=n},{"../../util":37,"../primitive":6,"./types":14}],10:[function(t,e){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../primitive"),n=function(t){function e(t,n,r){this.children=[],e.__super__.constructor.call(this,t,n,r)}return o(e,t),e.prototype.add=function(t){return this.children.push(t),t._added(this)},e.prototype.remove=function(t){var e;return this.children=function(){var n,r,i,o;for(i=this.children,o=[],n=0,r=i.length;r>n;n++)e=i[n],e!==t&&o.push(e);return o}.call(this),t._removed(this)},e}(r),e.exports=n},{"../primitive":6}],11:[function(t,e,n){var r;r={axis:t("./axis"),cartesian:t("./cartesian"),grid:t("./grid"),group:t("./group"),root:t("./root"),view:t("./view")},n.Classes=r,n.Types=t("./types"),n.Traits=t("./traits")},{"./axis":7,"./cartesian":8,"./grid":9,"./group":10,"./root":12,"./traits":13,"./types":14,"./view":15}],12:[function(t,e){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./group"),r=function(t){function e(t,n,r){e.__super__.constructor.call(this,t,n,r),this.root=this}return o(e,t),e}(n),e.exports=r},{"./group":10}],13:[function(t,e){var n,r;r=t("./types"),n={object:{position:r.vec4(),rotation:r.quat(),scale:r.vec4(1,1,1,1),visible:r.bool(!0)},style:{opacity:r.number(1),color:r.color()},data:{position:r.object(),color:r.object()},line:{width:r.number(.01)},view:{dimensions:r.number(3),range:r.array(r.vec2(-1,1),4)},axis:{inherit:r.bool(!0),range:r.vec2(-1,1),dimension:r.number(1),detail:r.number(1)},ticks:{divide:r.number(10),unit:r.number(1),base:r.number(10),scale:r.scale(),size:r.number(5)}},e.exports=n},{"./types":14}],14:[function(t,e){var n;n={array:function(t,e){return{uniform:function(){return t.uniform()+"v"},make:function(){var n,r,i;for(i=[],n=r=0;e>=0?e>r:r>e;n=e>=0?++r:--r)i.push(t.make());return i},validate:function(n,r){var i,o,s,u,a,c;if(null!=n.constructor&&n.constructor===Array)for(r.length=e?e:n.length,i=s=0,a=r.length;a>=0?a>s:s>a;i=a>=0?++s:--s)o=t.validate(n[i],r[i]),null!=o&&(r[i]=o);else for(r.length=e,i=u=0,c=r.length;c>=0?c>=u:u>=c;i=c>=0?++u:--u)r[i]=t.value}}},bool:function(t){return{uniform:function(){return"f"},make:function(){return!!t},validate:function(t){return!!t}}},number:function(t){return null==t&&(t=0),{uniform:function(){return"f"},make:function(){return+t},validate:function(t){return+t||0}}},string:function(t){return null==t&&(t=""),{make:function(){return""+t},validate:function(t){return""+t}}},scale:function(t){return new n.string(t)},object:function(){return{make:function(){return{}},validate:function(t){return t}}},vec2:function(t,e){var n;return null==t&&(t=0),null==e&&(e=0),n=[t,e],{uniform:function(){return"v2"},make:function(){return new THREE.Vector2(t,e)},validate:function(r,i){r instanceof THREE.Vector2?i.copy(r):(null!=r?r.constructor:void 0)===Array?(r=r.concat(n.slice(r.length)),i.set.apply(i,r)):i.set(t,e)}}},vec3:function(t,e,n){var r;return null==t&&(t=0),null==e&&(e=0),null==n&&(n=0),r=[t,e,n],{uniform:function(){return"v3"},make:function(){return new THREE.Vector3(t,e,n)},validate:function(i,o){i instanceof THREE.Vector3?o.copy(i):(null!=i?i.constructor:void 0)===Array?(i=i.concat(r.slice(i.length)),o.set.apply(o,i)):o.set(t,e,n)}}},vec4:function(t,e,n,r){var i;return null==t&&(t=0),null==e&&(e=0),null==n&&(n=0),null==r&&(r=0),i=[t,e,n,r],{uniform:function(){return"v4"},make:function(){return new THREE.Vector4(t,e,n,r)},validate:function(o,s){o instanceof THREE.Vector4?s.copy(o):(null!=o?o.constructor:void 0)===Array?(o=o.concat(i.slice(o.length)),s.set.apply(s,o)):s.set(t,e,n,r)}}},mat4:function(t,e,n,r,i,o,s,u,a,c,l,h,p,f,d,y){var v;return null==t&&(t=1),null==e&&(e=0),null==n&&(n=0),null==r&&(r=0),null==i&&(i=0),null==o&&(o=1),null==s&&(s=0),null==u&&(u=0),null==a&&(a=0),null==c&&(c=0),null==l&&(l=1),null==h&&(h=0),null==p&&(p=0),null==f&&(f=0),null==d&&(d=0),null==y&&(y=1),v=[t,e,n,r,i,o,s,u,a,c,l,h,p,f,d,y],{uniform:function(){return"m4"},make:function(){return new THREE.Matrix4(t,e,n,r,i,o,s,u,a,c,l,h,p,f,d,y)},validate:function(m,g){m instanceof THREE.Matrix4?g.copy(m):(null!=m?m.constructor:void 0)===Array?(m=m.concat(v.slice(m.length)),g.set.apply(g,m)):g.set(t,e,n,r,i,o,s,u,a,c,l,h,p,f,d,y)}}},quat:function(t,e,r,i){var o;return null==t&&(t=0),null==e&&(e=0),null==r&&(r=0),null==i&&(i=1),o=n.vec4(t,e,r,i),{uniform:function(){return"v4"},make:function(){return new THREE.Quaternion},validate:function(t,e){var n;return t instanceof THREE.Quaternion?e.copy(t):n=o.validate(t,e),(null!=n?n:e).normalize(),n}}},color:function(t,e,r){var i;return null==t&&(t=.5),null==e&&(e=.5),null==r&&(r=.5),i=n.vec3(t,e,r),{uniform:function(){return"v3"},make:function(){return new THREE.Vector3(t,e,r)},validate:function(t,e){var n;return t===""+t?(n=t,t=(new THREE.Color).setStyle(n)):t===+t&&(t=new THREE.Color(t)),t instanceof THREE.Color?void e.set(t.r,t.g,t.b):i.validate(t,e)}}}},e.exports=n},{}],15:[function(t,e){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./group"),r=t("../../util").Range,i=function(t){function e(t,n,r){this._traits("object","view"),e.__super__.constructor.call(this,t,n,r)}return s(e,t),e.prototype.axis=function(t){var e;return e=this.get("view.range")[t-1]},e.prototype.to=function(){},e}(n),e.exports=i},{"../../util":37,"./group":10}],16:[function(t,e){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../renderable"),n=function(t){function e(t,n){null==this.samples&&(this.samples=n.samples||1),null==this.channels&&(this.channels=n.channels||4),e.__super__.constructor.call(this,t),this.build()}var n;return o(e,t),n=65535,e.prototype.build=function(){return this.uniforms={dataPointer:{type:"v2",value:new THREE.Vector2}}},e.prototype.dispose=function(){return this.data=null,this.texture.dispose(),e.__super__.dispose.apply(this,arguments)},e.prototype.update=function(){return this.iterate(),this.write()},e.prototype.copy=function(t){var e,n,r;for(n=Math.min(t.length,this.samples*this.channels),e=r=0;n>=0?n>r:r>n;e=n>=0?++r:--r)this.data[e]=t[e];return this.write()},e.prototype.write=function(){},e.prototype.iterate=function(){},e.prototype.generate=function(){var t,e,n,r;switch(n=this.samples,t=this.data,e=!1,r=0,this.channels){case 1:return function(i){return e||(t[r++]=i||0),!(e=r>=n)};case 2:return function(i,o){return e||(t[r++]=i||0,t[r++]=o||0),!(e=r>=n)};case 3:return function(i,o,s){return e||(t[r++]=i||0,t[r++]=o||0,t[r++]=s||0),!(e=r>=n)};case 4:return function(i,o,s,u){return e||(t[r++]=i||0,t[r++]=o||0,t[r++]=s||0,t[r++]=u||0),!(e=r>=n)}}},e}(r),e.exports=n},{"../renderable":28}],17:[function(t,e,n){n.Texture=t("./texture"),n.Buffer=t("./buffer"),n.LineBuffer=t("./linebuffer"),n.SurfaceBuffer=t("./surfacebuffer")},{"./buffer":16,"./linebuffer":18,"./surfacebuffer":19,"./texture":20}],18:[function(t,e){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./buffer"),i=t("./texture"),r=function(t){function e(t,n){this.callback=n.callback||function(){},this.width=n.width||1,this.history=n.history||1,this.samples=this.width,e.__super__.constructor.call(this,t,n)}return s(e,t),e.prototype.build=function(){return e.__super__.build.apply(this,arguments),this.data=new Float32Array(this.samples*this.channels),this.texture=new i(this.gl,this.samples,this.history,this.channels),this.index=0,this.dataPointer=this.uniforms.dataPointer.value,this._adopt(this.texture.uniforms)},e.prototype.iterate=function(){var t,e,r;for(t=this.callback,r=this.generate(),e=0;t(e++,r)&&e<n.iterationLimit;);},e.prototype.write=function(){return this.texture.write(this.data,0,this.index,this.samples,1),this.dataPointer.set(.5,this.index+.5),this.index=(this.index+1)%this.history},e}(n),e.exports=r},{"./buffer":16,"./texture":20}],19:[function(t,e){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./buffer"),i=t("./texture"),r=function(t){function e(t,n){this.callback=n.callback||function(){},this.width=n.width||1,this.height=n.height||1,this.history=n.history||1,this.channels=n.channels||4,this.samples=this.width*this.height,e.__super__.constructor.call(this,t,n)}return s(e,t),e.prototype.build=function(){return e.__super__.build.apply(this,arguments),this.data=new Float32Array(this.samples*this.channels),this.texture=new i(this.gl,this.width,this.height*this.history,this.channels),this.index=0,this.dataPointer=this.uniforms.dataPointer.value,this._adopt(this.texture.uniforms)},e.prototype.iterate=function(){var t,e,r,i,o,s,u;for(t=this.callback,s=this.generate(),o=this.width,e=r=i=0;++i<n.iterationLimit&&(u=t(e,r,s));)++e===o&&(e=0,r++)},e.prototype.write=function(){return this.texture.write(this.data,0,this.index,this.width,this.height),this.dataPointer.set(.5,this.index+.5),this.index=(this.index+1)%this.history},e}(n),e.exports=r},{"./buffer":16,"./texture":20}],20:[function(t,e){var n;n=function(){function t(t,e,n,r){this.gl=t,this.width=e,this.height=n,this.channels=r,this.n=this.width*this.height*this.channels,this.build()}return t.prototype.build=function(){var t;return t=this.gl,this.texture=t.createTexture(),this.type=[null,t.LUMINANCE,t.LUMINANCE_ALPHA,t.RGB,t.RGBA][this.channels],t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.data=new Float32Array(this.n),t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,this.type,t.FLOAT,this.data),this.textureObject=new THREE.Texture(new Image,new THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter),this.textureObject.__webglInit=!0,this.textureObject.__webglTexture=texture,this.uniforms={dataResolution:{type:"v2",value:new THREE.Vector2(1/this.width,1/this.height)},dataTexture:{type:"t",value:this.textureObject}}},t.prototype.write=function(t,e,n,r,i){var o;return o=this.gl,o.bindTexture(o.TEXTURE_2D,this.texture),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.texSubImage2D(o.TEXTURE_2D,0,e,n,r,i,this.type,o.FLOAT,t)},t.prototype.dispose=function(){throw"Texture::dispose not yet implemented"},t}(),e.exports=n},{}],21:[function(t,e){var n;n=function(){function t(t,e){this.gl=t,this.classes=e}return t.prototype.getTypes=function(){return Object.keys(this.classes)},t.prototype.make=function(t,e,n){return new this.classes[t](this.gl,e,n)},t}(),e.exports=n},{}],22:[function(t,e){var n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=function(t){function e(){THREE.BufferGeometry.call(this)}return i(e,t),e.prototype._emitter=function(t){var e,n,r,i,o,s,u,a;return n=this.attributes[t],r=n.itemSize,e=n.array,o=0,s=function(t){return e[o++]=t},a=function(t,n){return e[o++]=t,e[o++]=n},u=function(t,n,r){return e[o++]=t,e[o++]=n,e[o++]=r},i=function(t,n,r,i){return e[o++]=t,e[o++]=n,e[o++]=r,e[o++]=i},[null,s,a,u,i][r]},e}(THREE.BufferGeometry),e.exports=n},{}],23:[function(t,e,n){n.Geometry=t("./geometry"),n.LineGeometry=t("./linegeometry")},{"./geometry":22,"./linegeometry":24}],24:[function(t,e){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./geometry"),r=function(t){function e(t){var e,n,r,i,o,s,u,a,c,l,h,p,f,d,y,v,m,g,_,x,b,w,E;for(THREE.BufferGeometry.call(this),this.samples=p=+t.samples||2,this.strips=d=+t.strips||1,this.ribbons=h=+t.ribbons||1,this.segments=f=p-1,a=p*d*h*2,l=f*d*h,y=2*l,this.addAttribute("index",Uint16Array,3*y,1),this.addAttribute("position",Float32Array,a,3),this.addAttribute("line",Float32Array,a,2),i=this._emitter("index"),c=this._emitter("position"),u=this._emitter("line"),e=0,r=g=0;h>=0?h>g:g>h;r=h>=0?++g:--g)for(o=_=0;d>=0?d>_:_>d;o=d>=0?++_:--_){for(s=x=0;p>=0?p>=x:x>=p;s=p>=0?++x:--x)i(e),i(e+1),i(e+2),i(e+2),i(e+1),i(e+3),e+=2;e+=2}for(r=b=0;h>=0?h>b:b>h;r=h>=0?++b:--b){for(m=0,o=w=0;d>=0?d>w:w>d;o=d>=0?++w:--w)for(v=0,s=E=0;p>=0?p>E:E>p;s=p>=0?++E:--E)n=0===s?-1:s===f?1:0,c(v,m,0),c(v,m,0),u(n,1),u(n,-1),v++;m++}this.clip(0,l)}return o(e,t),e.prototype.shaderAttributes=function(){return{line:{type:"v2",value:null}}},e.prototype.clip=function(t,e){return this.offsets=[{start:6*t,count:6*(e-t)}]},e}(n),e.exports=r},{"./geometry":22}],25:[function(t,e,n){n.Scene=t("./scene"),n.Factory=t("./factory"),n.Renderable=t("./scene"),n.Types=t("./types")},{"./factory":21,"./scene":29,"./types":30}],26:[function(t,e,n){n.Line=t("./line")},{"./line":27}],27:[function(t,e){var n,r,i,o,s,u={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s="\n/*\n//Data sampler\n\nuniform sampler2D dataTexture;\nuniform vec2 dataResolution;\nuniform vec2 dataPointer;\n\nvec2 mapUV(vec2 xy) {\n  return vec2(xy.y, 0);\n}\n\nvec4 sampleData(vec2 xy) {\n  vec2 uv = fract((mapUV(xy) + dataPointer) * dataResolution);\n  vec4 sample = texture2D(dataTexture, uv);\n  return transformData(uv, sample);\n}\n\n*/\n\n/*\n// Grid\nuniform vec2 gridRange;\nuniform vec4 gridAxis;\nuniform vec4 gridOffset;\n\nvec4 transformData(vec2 uv, vec4 data) {\n  return vec4(data.r, 0, 0, 0) + gridAxis * uv.x + gridOffset;\n}\n*/\n\n/*\n// Axis\n*/\nuniform vec4 axisStep;\nuniform vec4 axisPosition;\n\nvec4 sampleData(vec2 uv) {\n  return axisStep * uv.x + axisPosition;\n}\n\n/*\n// Viewport\n*/\nuniform mat4 cartesianMatrix;\n\nvec4 cartesian(vec4 position) {\n//  return cartesianMatrix * vec4(position.xyz, 1.0);\n  return vec4(position.xyz, 1.0);\n}\n\n/*\nvec4 cartesian4(vec4 position) {\n  return cartesian4Matrix * position;\n}\n*/\n\n/*\n// Pipeline\n*/\nvec3 worldToView(vec4 position) {\n  return (modelViewMatrix * vec4(position.xyz, 1.0)).xyz;\n}\n\nvec3 transformToView(vec4 position) {\n  return worldToView(cartesian(position));\n}\n\nvec3 samplePosition(vec2 xy) {\n  vec4 sample = sampleData(xy);\n  return transformToView(sample);\n}\n\n\n/*\n//Line\n*/\n\nvoid getLineGeometry(vec2 xy, float edge, inout vec3 left, inout vec3 center, inout vec3 right) {\n  vec2 step = vec2(1.0, 0.0);\n\n  center = samplePosition(xy);\n  left = (edge < -0.5) ? center : samplePosition(xy - step);\n  right = (edge > 0.5) ? center : samplePosition(xy + step);\n}\n\nvec3 getLineJoin(float edge, vec3 left, vec3 center, vec3 right) {\n  vec3 bitangent;\n  vec3 normal = center;\n\n  vec3 legLeft = center - left;\n  vec3 legRight = right - center;\n\n  if (edge > 0.5) {\n    bitangent = normalize(cross(normal, legLeft));\n  }\n  else if (edge < -0.5) {\n    bitangent = normalize(cross(normal, legRight));\n  }\n  else {\n    vec3 joinLeft = normalize(cross(normal, legLeft));\n    vec3 joinRight = normalize(cross(normal, legRight));\n    float dotLR = dot(joinLeft, joinRight);\n    float scale = min(8.0, tan(acos(dotLR * .999) * .5) * .5);\n    bitangent = normalize(joinLeft + joinRight) * sqrt(1.0 + scale * scale);\n  }\n  \n  return bitangent;\n}\n\nuniform float lineWidth;\nattribute vec2 line;\n//attribute vec3 position;\n\nvec3 getLinePosition() {\n  vec3 left, center, right, join;\n\n  float edge = line.x;\n  float offset = line.y;\n\n  getLineGeometry(position.xy, edge, left, center, right);\n  join = getLineJoin(edge, left, center, right);\n  return center + join * offset * lineWidth;\n}\n\n////\n\nvoid projectPosition(vec3 point) {\n	vec4 glPosition = projectionMatrix * vec4(point, 1.0);\n  gl_Position = glPosition;\n}\n\nvoid main() {\n  vec3 position = getLinePosition();\n  projectPosition(position);\n}",o="uniform vec3 lineColor;\nuniform float lineOpacity;\n\nvoid main() {\n	gl_FragColor = vec4(lineColor, lineOpacity);\n}",i=t("../renderable"),r=t("../geometry").LineGeometry,n=function(t){function e(t,n){var i,u,a;e.__super__.constructor.call(this,t),u=null!=(a=n.uniforms)?a:{},i=n.buffer,this._adopt(u),this.geometry=new r({samples:n.samples||2,strips:n.strips||1,ribbons:n.ribbons||1}),this.material=new THREE.ShaderMaterial({attributes:this.geometry.shaderAttributes(),uniforms:this.uniforms,vertexShader:s,fragmentShader:o,side:THREE.DoubleSide,defaultAttributeValues:null}),this.object=new THREE.Mesh(this.geometry,this.material),this.object.frustumCulled=!1}return a(e,t),e.prototype.dispose=function(){return this.geometry.dispose(),this.material.dispose(),this.object=this.geometry=this.material=null,e.__super__.dispose.apply(this,arguments)},e}(i),e.exports=n},{"../geometry":23,"../renderable":28}],28:[function(t,e){var n;n=function(){function t(t){this.gl=t,null==this.uniforms&&(this.uniforms={})}return t.prototype.dispose=function(){return this.uniforms=null},t.prototype._adopt=function(t){var e,n;for(e in t)n=t[e],this.uniforms[e]=n},t.prototype._set=function(t){var e,n;for(e in t)n=t[e],null!=this.uniforms[e]&&(this.uniforms[e].value=n)},t}(),e.exports=n},{}],29:[function(t,e){var n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=function(){function t(t){var e;this.scene=t,e=function(t){function e(){THREE.Object3D.apply(this)}return i(e,t),e}(THREE.Object3D),this.root=new e}return t.prototype.getRoot=function(){return this.root},t.prototype.inject=function(){return this.scene.add(this.root)},t.prototype.unject=function(){return this.scene.remove(this.root)},t.prototype.add=function(t){return this.root.add(t)},t.prototype.remove=function(t){return this.root.remove(t)},t}(),e.exports=n},{}],30:[function(t,e,n){var r;r={line:t("./meshes").Line,databuffer:t("./buffer").DataBuffer,linebuffer:t("./buffer").LineBuffer,surfacebuffer:t("./buffer").SurfaceBuffer},n.Classes=r},{"./buffer":17,"./meshes":26}],31:[function(t,e){var n;n=function(){function t(t){this.model=t}return t.prototype.update=function(){},t}(),e.exports=n},{}],32:[function(t,e){var n;n=function(){function t(t,e,n,r,i){var o,s,u,a;for(this._controller=t,this._animator=e,this._director=n,this._up=r,this._target=i,a=this._controller.getTypes(),s=0,u=a.length;u>s;s++)o=a[s],"root"!==o&&"group"!==o&&!function(t){return function(e){return t[e]=function(n){return t.add(e,n)}}}(this)(o);this._model=this._controller.model}return t.prototype.add=function(t,e){var n,r,i,o;return r=this._controller.make(t,e),i=null!=(o=this.target)?o:this._controller.getRoot(),r.children||i!==this._controller.getRoot()||(i=function(){var t,e,r,o;for(r=i.children,o=[],t=0,e=r.length;e>t;t++)n=r[t],null!=n.children&&o.push(n);return o}()[0]||i),this._controller.add(r,i),r.children?this.push(r):this},t.prototype.push=function(e){return new t(this._controller,this._animator,this._director,this,e)},t.prototype.end=function(){var t;return null!=(t=this._up)?t:this},t.prototype.reset=function(){return push({target:void 0})},t}(),e.exports=n},{}],33:[function(t,e){var n;n=function(){function t(t,e,n){this.model=t,this.scene=e,this.factory=n,this.model.setRoot(this.factory.make("root")),this.render=function(t){return function(e){return t.scene.add(e.renderable.object)}}(this),this.unrender=function(t){return function(e){return t.scene.remove(e.renderable.object)}}(this)}return t.prototype.getRoot=function(){return this.model.getRoot()},t.prototype.getTypes=function(){return this.factory.getTypes()},t.prototype.make=function(t,e){return this.factory.make(t,e)},t.prototype.add=function(t,e){return null==e&&(e=this.model.getRoot()),t.on("render",this.render),t.on("unrender",this.unrender),e.add(t)},t.prototype.remove=function(t){var e;return e=t.parent||this.model.getRoot(),e.remove(t),t.off("render",this.render),t.off("unrender",this.unrender)
},t}(),e.exports=n},{}],34:[function(t,e){var n;n=function(){function t(t,e){this.model=t,this.script=e}return t}(),e.exports=n},{}],35:[function(t,e,n){n.Animator=t("./animator"),n.API=t("./api"),n.Controller=t("./controller"),n.Director=t("./director"),n.Model=t("./model")},{"./animator":31,"./api":32,"./controller":33,"./director":34,"./model":36}],36:[function(t,e){var n;n=function(){function t(t){this.camera=t}return t.prototype.setRoot=function(t){this.root=t},t.prototype.getRoot=function(){return this.root},t}(),e.exports=n},{}],37:[function(t,e,n){n.Ticks=t("./ticks")},{"./ticks":38}],38:[function(t,e,n){var r,i,o;r=function(t,e,n,r,i,o,s){var u,a,c,l,h,p,f,d,y,v,m,g,_,b;for(n||(n=10),s||(s=0),d=e-t,p=d/n,r||(r=1),i||(i=10),f=r*(s+Math.pow(i,Math.floor(Math.log(p/r)/Math.log(i)))),l=i%2===0?[i/2,1,.5]:i%3===0?[i/3,1,1/3]:[1],m=0,_=l.length;_>m;m++)c=l[m],v=f*c;for(u=1/0,y=v.reduce(function(t,e){var n;return n=Math.abs(e-p),u>n?(u=n,e):t},f),a=+!o,t=(Math.ceil(t/y)+a)*y,e=(Math.floor(e/y)-a)*y,n=Math.ceil((e-t)/y),b=[],h=g=0;n>=0?n>=g:g>=n;h=n>=0?++g:--g)b.push(t+x*y);return b},i=function(){throw"Log ticks not yet implemented."},o=function(t,e,n,r,i,o,s,u){switch(scale){case"linear":return Ticks.linear(e,n,r,i,o,s,u);case"log":return Ticks.log(e,n,r,i,o,s,u)}},n.make=o,n.linear=r,n.log=i},{}]},{},[2]);